<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="../../static/log_app/css/list.css">
</head>
<body>
  <h1>StudentList</h1>
  <p>(一応)がついてるのは、園側が管理できるようにするつもり</p>
  <a href="{% url 'create-student' %}">生徒の追加(一応)</a>
  <h1>生徒情報検索</h1>
  <form id="search-form">
    <input type="text" name="q" placeholder="名前で検索">
    <button type="submit">検索</button>
</form>

<div id="search-results">
    <!-- 検索結果がここに表示されます -->
</div>

<script>
    document.getElementById('search-form').addEventListener('submit', function(event) {
        event.preventDefault();  // フォームのデフォルトの動作を止める
        var query = document.querySelector('input[name="q"]').value;
        
        fetch(`/search/?q=${query}`)
        .then(response => response.json())
        .then(data => {
            var resultsDiv = document.getElementById('search-results');
            resultsDiv.innerHTML = '';  // 結果をクリア
            data.results.forEach(function(result) {
                var resultItem = document.createElement('div');
                resultItem.textContent = `名前: ${result.name}, 年齢: ${result.age}, クラス: ${result.class_name}`;
                resultsDiv.appendChild(resultItem);
            });
        });
    });
</script>

  <table>
    <tr>
      <th>園ID</th>
      <th>生徒ID</th>
      <th>氏名</th>
      <th>担任</th>
      <th>生年月日</th>
      <th>アレルギー</th>
      <th>追記</th>
    </tr>
    {% for student in students %}
    <tr>
      <td>{{ student.kindergarten }}</td>
      <td>{{ student.student_id }}</td>
      <td>{{ student.name }}</td>
      <td>{{ student.caregiver }}</td>
      <td>{{ student.birth_date }}</td>
      <td>{{ student.allergy_info }}</td>
      <td>{{ student.additional_info }}</td>
      <td><a href="{% url 'student' student.student_id %}">確認</a></td>
      <td><a href="{% url 'edit-student' student.student_id %}">編集(一応)</a></td>
      <td><a href="{% url 'delete-student' student.student_id %}">削除(一応)</a></td>
    </tr>
    {% endfor %}
  </table>
  <p><a href="{% url 'home'%}">戻る</a></p>
</body>
</html>
